<script type="text/javascript" charset="utf-8">
  $(document).ready(function () {
    $('#table_one_selector').change(function () {
      getAttrs($(this), '#attr_one_selector');
    });
    $('#table_two_selector').change(function () {
      getAttrs($(this), '#attr_two_selector');
    });
    function getAttrs(t, attr_id) {
      $.ajax({
        url: "<%= oracle_attrs_path %>",
        type: "GET",
        dataType: "json",
        data: {table: t.find('option:selected').text()},
        complete: function () {
        },
        success: function (data, test_staus, xhr) {
          var attrs = data.response;
          var options = '';
          for (var i = 0; i < attrs.length; i++) {
            options += '<option value="' + attrs[i] + '">' + attrs[i] + '</option>';
          }
          var attr_selector = $(attr_id);
          attr_selector.empty();
          attr_selector.append(options);
        }
      })
    }
  })
</script>
<%= bootstrap_form_tag url: selector_table_path, method: :post do |f| %>


    <%= f.select(:table1, options_for_select(@options_table), {label: 'Select the main table:' }, {id: 'table_one_selector' }) %>
    <%= f.select(:attr1, options_for_select([]), { label: 'Select the main table\'s attribute' }, { id: 'attr_one_selector' }) %>

    <%= f.select(:table2, options_for_select(@options_table), {label: 'Select the referenced table:' }, {id: 'table_two_selector' }) %>
    <%= f.select(:attr2, options_for_select([]), { label: 'Select the referenced attribute' }, { id: 'attr_two_selector' }) %>

    <%= f.form_group :embed do %>
        <%= f.label :embed_0 do %>
            Reference
            <%= radio_button_tag :embed, 0, text: 'Reference table', checked: true %>
        <% end %>
        <%= label_tag :embed_1 do %>
            Embed
        <%= radio_button_tag :embed, 1, text: 'Embed table' %>
        <% end %>
    <% end %>

    <%= f.primary 'Generate MongoDB script' %>



<% end %>